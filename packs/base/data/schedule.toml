# Base pack schedule
# Each [[slot]] defines a named timeslot available during the week.
# The scheduler evaluates conditions and does weighted random selection.

[[slot]]
name = "free_time"

  [[slot.events]]
  scene     = "base::rain_shelter"
  condition = "gd.week() > 0"
  weight    = 10

  [[slot.events]]
  scene     = "base::morning_routine"
  condition = "gd.week() >= 1"
  weight    = 15

  [[slot.events]]
  scene     = "base::coffee_shop"
  condition = "gd.week() >= 1"
  weight    = 10
  once_only = false

  [[slot.events]]
  scene     = "base::plan_your_day"
  weight    = 0
  trigger   = "gd.week() >= 2"
  once_only = true

  [[slot.events]]
  scene     = "base::bookstore"
  weight    = 8
  condition = "gd.week() >= 1"

  [[slot.events]]
  scene     = "base::park_walk"
  weight    = 10
  condition = "gd.week() >= 1"

  [[slot.events]]
  scene     = "base::grocery_store"
  weight    = 9
  condition = "gd.week() >= 1"

  [[slot.events]]
  scene     = "base::evening_home"
  weight    = 12
  condition = "gd.week() >= 1"

  [[slot.events]]
  scene     = "base::neighborhood_bar"
  weight    = 7
  condition = "gd.week() >= 2"

# ── Workplace opening arc ────────────────────────────────────────────────

[[slot]]
name = "workplace_opening"

  [[slot.events]]
  scene     = "base::workplace_arrival"
  condition = "gd.hasGameFlag('ROUTE_WORKPLACE')"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_WORKPLACE')"
  once_only = true

  [[slot.events]]
  scene     = "base::workplace_landlord"
  condition = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'arrived' && !gd.hasGameFlag('MET_LANDLORD')"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'arrived' && !gd.hasGameFlag('MET_LANDLORD')"
  once_only = true

  [[slot.events]]
  scene     = "base::workplace_first_night"
  condition = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'arrived'"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'arrived'"
  once_only = true

  [[slot.events]]
  scene     = "base::workplace_first_clothes"
  condition = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'week_one'"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'week_one'"
  once_only = true

  [[slot.events]]
  scene     = "base::workplace_first_day"
  condition = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'clothes_done'"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'clothes_done'"
  once_only = true

  [[slot.events]]
  scene     = "base::workplace_work_meeting"
  condition = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'working' && !gd.hasGameFlag('FIRST_MEETING_DONE')"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'working' && !gd.hasGameFlag('FIRST_MEETING_DONE')"
  once_only = true

  [[slot.events]]
  scene     = "base::workplace_evening"
  condition = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'working'"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_WORKPLACE') && gd.arcState('base::workplace_opening') == 'working' && gd.hasGameFlag('FIRST_MEETING_DONE')"
  once_only = true

# ── Work slot (post-arc, settled state) ──────────────────────────────

[[slot]]
name = "work"

  [[slot.events]]
  scene     = "base::work_standup"
  weight    = 10
  condition = "gd.arcState('base::workplace_opening') == 'settled' && gd.isWeekday()"

  [[slot.events]]
  scene     = "base::work_lunch"
  weight    = 10
  condition = "gd.arcState('base::workplace_opening') == 'settled'"

  [[slot.events]]
  scene     = "base::work_late"
  weight    = 8
  condition = "gd.arcState('base::workplace_opening') == 'settled'"

  [[slot.events]]
  scene     = "base::work_corridor"
  weight    = 12
  condition = "gd.arcState('base::workplace_opening') == 'settled'"

  [[slot.events]]
  scene     = "base::work_friday"
  weight    = 8
  condition = "gd.arcState('base::workplace_opening') == 'settled' && gd.isWeekday()"

  # Marcus follow-up scenes — gated by having had the work meeting
  [[slot.events]]
  scene     = "base::work_marcus_coffee"
  weight    = 9
  condition = "gd.arcState('base::workplace_opening') == 'settled' && gd.hasGameFlag('FIRST_MEETING_DONE')"

  [[slot.events]]
  scene     = "base::work_marcus_favor"
  weight    = 7
  condition = "gd.arcState('base::workplace_opening') == 'settled' && gd.hasGameFlag('FIRST_MEETING_DONE') && gd.npcLiking('ROLE_MARCUS') == 'Ok'"

# ── Campus opening arc ────────────────────────────────────────────────

[[slot]]
name = "campus_opening"

  [[slot.events]]
  scene     = "base::campus_arrival"
  condition = "gd.hasGameFlag('ROUTE_CAMPUS')"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_CAMPUS')"
  once_only = true

  [[slot.events]]
  scene     = "base::campus_dorm"
  condition = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'arrived'"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'arrived'"
  once_only = true

  [[slot.events]]
  scene     = "base::campus_orientation"
  condition = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'orientation'"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'orientation'"
  once_only = true

  [[slot.events]]
  scene     = "base::campus_library"
  condition = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'dorm_life'"
  weight    = 10
  once_only = true

  [[slot.events]]
  scene     = "base::campus_call_home"
  condition = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'dorm_life' && !gd.hasGameFlag('CALL_HOME_DONE')"
  weight    = 8
  once_only = true

  [[slot.events]]
  scene     = "base::campus_study_session"
  condition = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'dorm_life' && !gd.hasGameFlag('STUDY_SESSION_DONE')"
  weight    = 10
  once_only = true

  [[slot.events]]
  scene     = "base::campus_dining_hall"
  condition = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'dorm_life' && gd.hasGameFlag('STUDY_SESSION_DONE')"
  weight    = 0
  trigger   = "gd.hasGameFlag('ROUTE_CAMPUS') && gd.arcState('base::campus_opening') == 'dorm_life' && gd.hasGameFlag('STUDY_SESSION_DONE')"
  once_only = true
